<div x-data="{ open: false }" @click.away="open = false">
    <div @click="open = !open" class="relative">
        <div class="flex items-center cursor-pointer">
            <div class="flex items-center gap-2">
                <img src="{{ session.currency.country.flag }}" alt="{{ session.currency.code }}" class="w-5 h-5 mr-2" loading="lazy">
                <p>{{ session.currency.code }}</p>
            </div>
            <i class="fa-solid fa-chevron-down ml-2 px-1"></i>
        </div>
        <ul x-show="open" class="absolute left-0 mt-1 w-48 bg-white border border-gray-300 rounded-md shadow-md z-10">
            {% for storeCurrency in store.currencies %}
                <li :click="open = false; languageChange('{{ storeCurrency.code }}')" class="cursor-pointer">
                    <div class="py-2 px-3 flex items-center">
                        <img src="{{ storeCurrency.country.flag }}" alt="{{ storeCurrency.code }}" loading="lazy" class="w-5 h-5 mr-2">
                        <p>{{ storeCurrency.code }}</p>
                    </div>
                </li>
            {% endfor %}
        </ul>
    </div>
</div>

<script>
    function languageChange(code) {
        document.getElementById(code).click();
        setTimeout(() => {
            document.getElementById('modal-select-destination-city-save').click();
        }, 200);
    }
</script>
